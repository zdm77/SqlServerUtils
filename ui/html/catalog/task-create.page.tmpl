<script>
    {{if .Name}}
    //document.getElementById("nameTask").val=5

    {{end}}
</script>
{{template "base" .}}

{{define "main"}}

    <main class="form-main">
        <div class="card">
            <div class="card-header">
                Задача
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">
                    <div class="mb-3">
                        <label for="name" class="form-label">Наименование</label>
                        <input class="form-control" id="name" value={{ .Name}}>
                    </div>
                    <div class="mb-3">
                        <label for="table_db" class="form-label">Таблица БД</label>
                        <input class="form-control" id="table_db" value={{ .TableDb}}>
                    </div>
                    <button class="btn btn-primary" onclick="save()">Сохранить</button>
                </li>
                <li class="list-group-item">
                    <div class="container  table-responsive">
                        <table id="json_data"
                               class="table table-striped table-bordered table-sm table-responsive"></table>
                    </div>
                </li>
            </ul>
        </div>
        <script>
            function save() {
                let name = document.getElementById("name").value
                let table_db = document.getElementById("table_db").value

                fetch('/api/task-save',
                    {
                        method: 'PUT',
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({id: {{ .Id}}, name: name, table_db: table_db})
                    })
                    .then(response => response.json())
                    .then((response) => {
                        if (response.text=="ok") {
                            alert("Данные сохранены")
                        } else {
                            alert("Ошибка: "+response.text)
                        }
                    });
            }
        </script>
    </main>




{{end}}