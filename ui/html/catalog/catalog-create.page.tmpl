{{template "base" .}}

{{define "main"}}
    <main class="form-main">
        <div class="card">
            <div class="card-header">
                Задача
            </div>
            <form id='form'
                  encType="multipart/form-data">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <div class="row">
                            <div class="col-sm">
                                <label for="name" class="form-label">Наименование</label>
                                <input class="form-control" id="name" value={{ .Name}}>
                            </div>
                            <div class="col-sm">
                                <label for="table_db" class="form-label">Таблица БД</label>
                                <input class="form-control" id="table_name" value={{ .TableDb}}>
                            </div>
                        </div>
                    </li>
                </ul>
            </form>
            <div class="col-6">
                <button id="btnSave" style="margin-left: 15px" class="btn btn-primary bi bi-save" onclick="save()">
                    <span style="margin-left: 3px"></span>Сохранить
                </button>
            </div>
            <table id="json_data"
                   class="table table-striped table-bordered table-sm table-responsive"></table>
        </div>
        <script>
            const name = document.getElementById('name')
            name.addEventListener('keyup', function () {
                valid()

            });
            const tableDb = document.getElementById('table_name')
            tableDb.addEventListener('keyup', function () {
                valid()

            });

            function valid() {
                if (name.value === '' || tableDb.value === '') {
                    btnSave.disabled = true
                } else {
                    btnSave.disabled = false
                }
            }

            valid()

            function save() {
                fetch('/api/catalog-save',
                    {
                        method: 'POST',
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            id: id,
                            name: name.value,
                            table_name: tableDb.value,

                        })
                    })
                    .then(response => response.json())
                    .then((response) => {
                            
                    })
            }

            let id = {{ .Id}}
        </script>
    </main>
{{end}}